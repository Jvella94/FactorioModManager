<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:views="using:FactorioModManager.Views"
        x:Class="FactorioModManager.Views.SettingsWindow"
        x:DataType="views:SettingsWindow"
        Title="Settings"
        Width="600" Height="450"
        WindowStartupLocation="CenterOwner">
  <Grid Margin="20" RowDefinitions="Auto,Auto,Auto,Auto,Auto,Auto,Auto,Auto,Auto,*,Auto">

    <!-- Mods Directory -->
    <TextBlock Grid.Row="0" Text="Factorio Mods Directory:" Margin="0,0,0,5"/>
    <Grid Grid.Row="1" ColumnDefinitions="*,Auto" Margin="0,0,0,15">
      <TextBox Grid.Column="0" Text="{Binding ModsPath}" IsReadOnly="True" Margin="0,0,10,0"/>
      <Button Grid.Column="1" Content="Browse..." Click="BrowseModsPath"/>
    </Grid>

    <!-- API Key (for browsing mods) -->
    <TextBlock Grid.Row="2" Text="Mod Portal API Key (optional - for browsing):" Margin="0,0,0,5"/>
    <TextBox Grid.Row="3" Text="{Binding ApiKey}" Watermark="Enter your API key" Margin="0,0,0,15"/>

    <!-- Username (for downloading mods) -->
    <TextBlock Grid.Row="4" Text="Factorio Username (for downloads):" Margin="0,0,0,5"/>
    <TextBox Grid.Row="5" Text="{Binding Username}" Watermark="Auto-detected from Factorio" Margin="0,0,0,15"/>

    <!-- Token (for downloading mods) -->
    <TextBlock Grid.Row="6" Text="Factorio Token (for downloads):" Margin="0,0,0,5"/>
    <TextBox Grid.Row="7" Text="{Binding Token}" Watermark="Auto-detected from Factorio" PasswordChar="â€¢" Margin="0,0,0,15"/>

    <!-- Keep old mod files checkbox -->
    <CheckBox Grid.Row="8"
              Content="Keep old mod files when updating"
              IsChecked="{Binding KeepOldModFiles}"
              VerticalAlignment="Top"
              Margin="0,0,0,15"/>

    <!-- Info text -->
    <TextBlock Grid.Row="9"
               TextWrapping="Wrap"
               Foreground="#888"
               FontSize="11"
               VerticalAlignment="Top"
               Text="Username and Token are automatically loaded from Factorio's player-data.json file. You only need to enter them manually if auto-detection fails."/>

    <!-- Buttons -->
    <StackPanel Grid.Row="10" Orientation="Horizontal" HorizontalAlignment="Right" Spacing="10" Margin="0,10,0,0">
      <Button Content="Save" Click="SaveSettings" Width="80"/>
      <Button Content="Cancel" Click="CancelSettings" Width="80"/>
    </StackPanel>
  </Grid>
</Window>
